language: swift
osx_image: xcode11.3

branches:
  only:
    - master

cache:
  directories:

before_install:
 - mkdir -p  $HOME/Developer/tools || true
 - git clone --quiet --depth 1 https://github.com/DimaRU/polly.git $HOME/Developer/tools/polly

jobs:
  include:
  - name: "Mac Catalyst"
    xcode_destination: platform=macOS,variant=Mac Catalyst
    xcode_scheme: TridentCockpitiOS
  - name: "iOS Simulator"
    xcode_destination: platform=iOS Simulator,name=iPhone 8,OS=13.3
    xcode_scheme: TridentCockpitiOS
  - name: "macOS"
    xcode_destination: platform=macOS
    xcode_scheme: TridentCockpit
script: xcodebuild clean build -project TridentCockpit.xcodeproj CODE_SIGN_IDENTITY="" CODE_SIGNING_REQUIRED=NO ONLY_ACTIVE_ARCH=NO | xcpretty && exit ${PIPESTATUS[0]}
