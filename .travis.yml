language: swift
osx_image: xcode11.3

branches:
  only:
    - master

cache:
  directories:

before_install:
 - mkdir -p  $HOME/Developer/tools || true
 - git clone --quiet --depth 1 https://github.com/DimaRU/polly.git $HOME/Developer/tools/polly

jobs:
  include:
  - name: "Mac Catalyst"
    env: 
    - XCODE_DEST="platform=macOS,variant=Mac Catalyst"
    - XCODE_SCHEME=TridentCockpitiOS
  - name: "iOS Simulator"
    env: 
    - XCODE_DEST="platform=iOS Simulator,name=iPhone 8,OS=13.3"
    - XCODE_SCHEME=TridentCockpitiOS
  - name: "macOS"
    env: 
    - XCODE_DEST="platform=macOS"
    - XCODE_SCHEME=TridentCockpit
script: set -o pipefail && xcodebuild -project TridentCockpit.xcodeproj -scheme $XCODE_SCHEME -destination "$XCODE_DEST" build  CODE_SIGN_IDENTITY="" CODE_SIGNING_REQUIRED=NO ONLY_ACTIVE_ARCH=NO | xcpretty
